
<div align="center">
  <h1>Xygeni-Extensions</h1>
  <img src="img/xygeni.logo.png" alt="xygeni logo" width="250"/><br/>
  <i>End to End Software Supply Chain Security</i>
</div>

---

[![documentation](https://img.shields.io/badge/documentation-blue.svg)](https://docs.xygeni.io/)
[![xygeni.io](https://img.shields.io/badge/website-blue.svg)](https://xygeni.io/)
[![Project license](https://img.shields.io/github/license/xygeni/xygeni-extensions?style=flat-square)](LICENSE.md)

<details open="open">
<summary>Table of Contents</summary>

- [Overview](#overview)
- [How-To...](#how-to)
  - [Create a custom detector](#create-a-custom-detector) 
  - [Create a custom remediation](#create-a-custom-remediation)
  - [Create a guardrail or workflow action](#create-a-guardrail-or-workflow-action)
  - [Create a report loader for a third-party tool](#create-a-report-loader-for-a-third-party-tool)
  - [Create an activity sensor for a software system](#create-an-activity-sensor-for-a-software-system)
  - [Run an exporter for a third-party tool](#exporting-reports)
- [Contributing](#contributing)

</details>

# Overview 

This project aims at extending the Xygeni platform for End to End Software Supply Chain Security. 

This repository help partners and end-users to share their own extensions and to request for new ones, that could be added to the platform or even provided here for the community.

The repository contains documentation and examples for Xygeni extensions, including:

- custom detectors,
- activity sensors,
- third-party report ingest, 
- guardrail and workflow actions.

# How to...

The following sections document how to add a custom component to the Xygeni platform, in a way that it could be shared with other users.

## Create a custom detector

A Xygeni **detector** is a piece of logic that detects a security issue in a scanned target system such as source code, a source code repository or a container image, a CI/CD system or another software tool. A detector has YAML (.yml) file that configures the detector, possibly an implementation class (.java), and optionally an AsciiDoc (.adoc) file to document the issues raised by the detector.

Read [Developing Custom Detectors](extensions/custom_detectors/README.md) for full documentation.

## Create a custom remediation

Remediation is an important part for fixing security issues. Xygeni provides a remediation framework (named 'Rectify') that allows to create a **remediation playbook** for issues reported by a given detector. 

To add a custom remediation, create a new YAML file in the `conf.custom/remediation/<scan type>` directory.

Read [Developing Remediation](extensions/custom_remediations/README.md) for full documentation.

## Create a guardrail or workflow action

TBD

## Create a report loader for a third-party tool

Xygeni prioritization and response can be also used with security findings reported by third-party security tools (namely external scanners), both open-source and commercial. The scanner provides a report-upload command for uploading the structured reports generated by third-party security tools, in areas like Static Application Security Testing (SAST), Software Composition Analysis (SCA), or Secret Leaks / IaC Flaws Detection.

The `report-upload` framework is available with the scanner so new converters for unsupported formats could be added. Go to the [Report Upload](extensions/report_upload/README.md) section for full details on how to add a new tool format.

## Create an activity sensor for a software system

TBD


## Exporting reports

Xygeni exporters are shared to allow third-party tools to provide data in a format that Xygeni can ingest. 

### Kiuwan SAST Exporter

As a complement to Kiuwan SAST converter available in the Xygeni `report-upload` tool, here is an example of how to export the findings from Kiuwan.

Kiuwan is a powerful, end-to-end application security platform. Kiuwan Static Application Security Testing (SAST) product is the tool that detects security vulnerabilities in source code using static analysis.

The problem is that Xygeni does not provide a mechanism in the agent (Kiuwan Local Analyzer) for writing to a local file the findings from the tool.

To export the findings to a local file for uploading into third-party tools like Xygeni, the approach used was to register the custom rule [ExportRule](src/main/java/ext/kiuwan/ExportRule.java) provided that registers a task to export the findings at the end of the analysis.

See [Kiuwan Exporter](kiuwan/README.md) for full details on how to register the exporter in your Kiuwan account, and to upload exported reports from Kiuwan into Xygeni using the `report-upload` command.

### Sonarqube SAST Exporter

As a complement to Sonarqube SAST converter available in the Xygeni `report-upload` tool, here is an example of how to export the findings from Sonarqube (Server and Cloud) by using the Sonarqube Web API.

See [Sonarqube Exporter](extensions/exporter/sonarqube/README.md) for details.

# Contributing

First off, thanks for taking the time to contribute! Your efforts will help other xygeni users to get more value from the platform. We appreciate your contributions.

See [CONTRIBUTING](CONTRIBUTING.md) for further details about how to create an issue or a pull request for a bugfix or a new feature. 

# Security

Xygeni-extensions follows good security practices, but 100% security cannot be assured. Xygeni-extensions is provided **"as is"** without any **warranty**. Use at your own risk.

For more information and to report securitu issues, please refer to our [security documentation]()

# License

Please note that any contributions to Xygeni-Extensions (this project) are open-source under the terms of the Apache 2.0 license. 
See [LICENSE](LICENSE.md) for full details.